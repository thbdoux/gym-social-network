# notifications/translation_service.py
from typing import Dict, Any

class NotificationTranslationService:
    """Enhanced service to translate notification content based on user language preference"""
    
    # Enhanced translation dictionary with more explicit and engaging content
    TRANSLATIONS = {
        'en': {
            # === POST INTERACTIONS ===
            # Likes
            'notifications.like.push_title': 'üëç Like',
            'notifications.like.push_body': '{sender_display_name} liked your post: "{post_content}"',
            'notifications.like.title': 'Someone liked your post!',
            'notifications.like.body': '{sender_display_name} liked your post: "{post_content}"',
            'notifications.like.email_subject': '{sender_display_name} liked your post',
            'notifications.like.email_body': 'Hi! {sender_display_name} liked your post: "{post_content}". Check it out on the app!',
            
            # Comments
            'notifications.comment.push_title': 'üí¨ Comment',
            'notifications.comment.push_body': '{sender_display_name} commented on your post: "{comment_content}"',
            'notifications.comment.title': 'New comment on your post',
            'notifications.comment.body': '{sender_display_name} commented: "{comment_content}"',
            'notifications.comment.email_subject': 'New comment from {sender_display_name}',
            'notifications.comment.email_body': '{sender_display_name} commented on your post: "{comment_content}"',
            
            # Comment replies
            'notifications.comment_reply.push_title': '‚Ü™Ô∏è Reply',
            'notifications.comment_reply.push_body': '{sender_display_name} replied to your comment: "{reply_content}"',
            'notifications.comment_reply.title': 'New reply to your comment',
            'notifications.comment_reply.body': '{sender_display_name} replied to your comment: "{reply_content}"',
            'notifications.comment_reply.email_subject': '{sender_display_name} replied to your comment',
            'notifications.comment_reply.email_body': '{sender_display_name} replied to your comment: "{reply_content}"',
            
            # Mentions
            'notifications.mention.push_title': 'üì£ Mention',
            'notifications.mention.push_body': '{sender_display_name} mentioned you in a comment: "{comment_content}"',
            'notifications.mention.title': 'You were mentioned!',
            'notifications.mention.body': '{sender_display_name} mentioned you in a comment: "{comment_content}"',
            'notifications.mention.email_subject': '{sender_display_name} mentioned you',
            'notifications.mention.email_body': '{sender_display_name} mentioned you in a comment: "{comment_content}"',
            
            # Post reactions
            'notifications.post_reaction.push_title': 'üòç Reaction',
            'notifications.post_reaction.push_body': '{sender_display_name} reacted {reaction_emoji} to your post: "{post_content}"',
            'notifications.post_reaction.title': 'New reaction on your post',
            'notifications.post_reaction.body': '{sender_display_name} reacted {reaction_emoji} to your post',
            'notifications.post_reaction.email_subject': '{sender_display_name} reacted to your post',
            'notifications.post_reaction.email_body': '{sender_display_name} reacted {reaction_emoji} to your post: "{post_content}"',
            
            # Comment reactions
            'notifications.comment_reaction.push_title': 'üòä Reaction',
            'notifications.comment_reaction.push_body': '{sender_display_name} reacted {reaction_emoji} to your comment: "{comment_content}"',
            'notifications.comment_reaction.title': 'Someone reacted to your comment',
            'notifications.comment_reaction.body': '{sender_display_name} reacted {reaction_emoji} to your comment',
            'notifications.comment_reaction.email_subject': '{sender_display_name} reacted to your comment',
            'notifications.comment_reaction.email_body': '{sender_display_name} reacted {reaction_emoji} to your comment: "{comment_content}"',
            
            # Shares
            'notifications.share.push_title': 'üîÑ Share',
            'notifications.share.push_body': '{sender_display_name} shared your post: "{post_content}"',
            'notifications.share.title': 'Your post was shared!',
            'notifications.share.body': '{sender_display_name} shared your post with their followers',
            'notifications.share.email_subject': '{sender_display_name} shared your post',
            'notifications.share.email_body': '{sender_display_name} shared your post: "{post_content}". This helps spread your content!',
            
            # === SOCIAL INTERACTIONS ===
            # Friend requests
            'notifications.friend_request.push_title': 'üë• Friend Request',
            'notifications.friend_request.push_body': '{sender_display_name} wants to connect with you',
            'notifications.friend_request.title': 'Friend Request',
            'notifications.friend_request.body': '{sender_display_name} sent you a friend request',
            'notifications.friend_request.email_subject': 'Friend request from {sender_display_name}',
            'notifications.friend_request.email_body': '{sender_display_name} wants to be your friend on the app. Accept their request to connect!',
            
            # Friend request accepted
            'notifications.friend_accept.push_title': 'üéâ Friends',
            'notifications.friend_accept.push_body': '{sender_display_name} accepted your friend request',
            'notifications.friend_accept.title': 'You\'re now friends!',
            'notifications.friend_accept.body': '{sender_display_name} is now your friend',
            'notifications.friend_accept.email_subject': '{sender_display_name} accepted your friend request',
            'notifications.friend_accept.email_body': 'Great news! {sender_display_name} accepted your friend request. You can now see each other\'s activities.',
            
            # === PROGRAM INTERACTIONS ===
            # Program forked
            'notifications.program_fork.push_title': 'üç¥ Program',
            'notifications.program_fork.push_body': '{sender_display_name} forked your program "{original_program_name}"',
            'notifications.program_fork.title': 'Program Forked',
            'notifications.program_fork.body': '{sender_display_name} forked your program "{original_program_name}"',
            'notifications.program_fork.email_subject': '{sender_display_name} forked your program',
            'notifications.program_fork.email_body': '{sender_display_name} found your program "{original_program_name}" helpful and created their own version!',
            
            # Program shared
            'notifications.program_shared.push_title': 'üì§ Program',
            'notifications.program_shared.push_body': '{sender_display_name} shared "{program_name}" with you',
            'notifications.program_shared.title': 'Program Shared',
            'notifications.program_shared.body': '{sender_display_name} shared a program with you',
            'notifications.program_shared.email_subject': '{sender_display_name} shared a program with you',
            'notifications.program_shared.email_body': '{sender_display_name} shared their program "{program_name}" with you. Check it out!',
            
            # Program liked
            'notifications.program_liked.push_title': '‚ù§Ô∏è Program',
            'notifications.program_liked.push_body': '{sender_display_name} liked your program "{program_name}"',
            'notifications.program_liked.title': 'Program Liked',
            'notifications.program_liked.body': '{sender_display_name} liked your program "{program_name}"',
            'notifications.program_liked.email_subject': '{sender_display_name} liked your program',
            'notifications.program_liked.email_body': '{sender_display_name} liked your program "{program_name}". Keep creating great content!',
            
            # Program used
            'notifications.program_used.push_title': 'üèãÔ∏è Program',
            'notifications.program_used.push_body': '{sender_display_name} used your program "{program_name}" for their workout',
            'notifications.program_used.title': 'Program Used',
            'notifications.program_used.body': '{sender_display_name} used your program "{program_name}" for their workout',
            'notifications.program_used.email_subject': '{sender_display_name} used your program',
            'notifications.program_used.email_body': '{sender_display_name} completed a workout using your program "{program_name}". Your program is making an impact!',
            
            # === WORKOUT MILESTONES ===
            # Workout milestone
            'notifications.workout_milestone.push_title': 'üèÜ Milestone',
            'notifications.workout_milestone.push_body': 'You\'ve completed {workout_count} workouts! Keep it up!',
            'notifications.workout_milestone.title': 'üéâ Workout Milestone Reached!',
            'notifications.workout_milestone.body': 'Congratulations! You\'ve completed {workout_count} workouts. You\'re crushing your fitness goals!',
            'notifications.workout_milestone.email_subject': 'Milestone Achievement: {workout_count} Workouts!',
            'notifications.workout_milestone.email_body': 'Amazing work! You\'ve reached a major milestone by completing {workout_count} workouts. Keep up the fantastic progress!',
            
            # Streak milestone
            'notifications.streak_milestone.push_title': 'üî• Streak',
            'notifications.streak_milestone.push_body': '{streak_days} days workout streak! You\'re on fire!',
            'notifications.streak_milestone.title': 'Streak Achievement!',
            'notifications.streak_milestone.body': 'Incredible! You\'ve maintained a {streak_days}-day workout streak',
            'notifications.streak_milestone.email_subject': 'Streak Milestone: {streak_days} Days!',
            'notifications.streak_milestone.email_body': 'You\'re unstoppable! You\'ve maintained a {streak_days}-day workout streak. Consistency is key to success!',
            
            # Personal record
            'notifications.personal_record.push_title': 'üí™ PR',
            'notifications.personal_record.push_body': 'New personal record in {exercise_name}: {new_weight}{weight_unit}',
            'notifications.personal_record.title': 'Personal Record!',
            'notifications.personal_record.body': 'You set a new personal record in {exercise_name}: {new_weight}{weight_unit} (previous: {previous_weight}{weight_unit})',
            'notifications.personal_record.email_subject': 'New Personal Record in {exercise_name}!',
            'notifications.personal_record.email_body': 'Congratulations! You just set a new personal record in {exercise_name}: {new_weight}{weight_unit}. Previous best was {previous_weight}{weight_unit}. Keep pushing those limits!',
            
            # === GROUP WORKOUT INTERACTIONS ===
            # Workout invitation
            'notifications.workout_invitation.push_title': 'üèãÔ∏è‚Äç‚ôÄÔ∏è Invitation',
            'notifications.workout_invitation.push_body': '{sender_display_name} invited you to "{workout_title}" on {scheduled_time}',
            'notifications.workout_invitation.title': 'Group Workout Invitation',
            'notifications.workout_invitation.body': '{sender_display_name} invited you to join "{workout_title}" on {scheduled_time}',
            'notifications.workout_invitation.email_subject': 'Workout invitation from {sender_display_name}',
            'notifications.workout_invitation.email_body': '{sender_display_name} invited you to join their group workout "{workout_title}" scheduled for {scheduled_time}. Join them for a great workout session!',
            
            # Someone joined workout
            'notifications.workout_join.push_title': 'üéâ Workout',
            'notifications.workout_join.push_body': '{sender_display_name} joined your workout "{workout_title}"',
            'notifications.workout_join.title': 'New Participant',
            'notifications.workout_join.body': '{sender_display_name} joined your group workout "{workout_title}"',
            'notifications.workout_join.email_subject': '{sender_display_name} joined your workout',
            'notifications.workout_join.email_body': 'Great news! {sender_display_name} joined your group workout "{workout_title}". The more the merrier!',
            
            # Test notification
            'notifications.test.push_title': 'üß™ Test',
            'notifications.test.push_body': 'This is a test push notification from your fitness app!',
            'notifications.test.title': 'Test Notification',
            'notifications.test.body': 'Test notification - everything is working correctly!',
            'notifications.test.email_subject': 'Test notification',
            'notifications.test.email_body': 'This is a test email notification to verify your notification settings are working correctly.',
        },
        'fr': {
            # === INTERACTIONS POSTS ===
            # Likes
            'notifications.like.push_title': 'üëç J\'aime',
            'notifications.like.push_body': '{sender_display_name} a aim√© votre post : "{post_content}"',
            'notifications.like.title': 'Quelqu\'un a aim√© votre post !',
            'notifications.like.body': '{sender_display_name} a aim√© votre post : "{post_content}"',
            'notifications.like.email_subject': '{sender_display_name} a aim√© votre post',
            'notifications.like.email_body': 'Salut ! {sender_display_name} a aim√© votre post : "{post_content}". Consultez l\'app !',
            
            # Commentaires
            'notifications.comment.push_title': 'üí¨ Commentaire',
            'notifications.comment.push_body': '{sender_display_name} a comment√© votre post : "{comment_content}"',
            'notifications.comment.title': 'Nouveau commentaire sur votre post',
            'notifications.comment.body': '{sender_display_name} a comment√© : "{comment_content}"',
            'notifications.comment.email_subject': 'Nouveau commentaire de {sender_display_name}',
            'notifications.comment.email_body': '{sender_display_name} a comment√© votre post : "{comment_content}"',
            
            # R√©ponses aux commentaires
            'notifications.comment_reply.push_title': '‚Ü™Ô∏è R√©ponse',
            'notifications.comment_reply.push_body': '{sender_display_name} a r√©pondu √† votre commentaire : "{reply_content}"',
            'notifications.comment_reply.title': 'Nouvelle r√©ponse √† votre commentaire',
            'notifications.comment_reply.body': '{sender_display_name} a r√©pondu √† votre commentaire : "{reply_content}"',
            'notifications.comment_reply.email_subject': '{sender_display_name} a r√©pondu √† votre commentaire',
            'notifications.comment_reply.email_body': '{sender_display_name} a r√©pondu √† votre commentaire : "{reply_content}"',
            
            # Mentions
            'notifications.mention.push_title': 'üì£ Mention',
            'notifications.mention.push_body': '{sender_display_name} vous a mentionn√© dans un commentaire : "{comment_content}"',
            'notifications.mention.title': 'Vous avez √©t√© mentionn√© !',
            'notifications.mention.body': '{sender_display_name} vous a mentionn√© dans un commentaire : "{comment_content}"',
            'notifications.mention.email_subject': '{sender_display_name} vous a mentionn√©',
            'notifications.mention.email_body': '{sender_display_name} vous a mentionn√© dans un commentaire : "{comment_content}"',
            
            # R√©actions aux posts
            'notifications.post_reaction.push_title': 'üòç R√©action',
            'notifications.post_reaction.push_body': '{sender_display_name} a r√©agi {reaction_emoji} √† votre post : "{post_content}"',
            'notifications.post_reaction.title': 'Nouvelle r√©action sur votre post',
            'notifications.post_reaction.body': '{sender_display_name} a r√©agi {reaction_emoji} √† votre post',
            'notifications.post_reaction.email_subject': '{sender_display_name} a r√©agi √† votre post',
            'notifications.post_reaction.email_body': '{sender_display_name} a r√©agi {reaction_emoji} √† votre post : "{post_content}"',
            
            # R√©actions aux commentaires
            'notifications.comment_reaction.push_title': 'üòä R√©action',
            'notifications.comment_reaction.push_body': '{sender_display_name} a r√©agi {reaction_emoji} √† votre commentaire : "{comment_content}"',
            'notifications.comment_reaction.title': 'Quelqu\'un a r√©agi √† votre commentaire',
            'notifications.comment_reaction.body': '{sender_display_name} a r√©agi {reaction_emoji} √† votre commentaire',
            'notifications.comment_reaction.email_subject': '{sender_display_name} a r√©agi √† votre commentaire',
            'notifications.comment_reaction.email_body': '{sender_display_name} a r√©agi {reaction_emoji} √† votre commentaire : "{comment_content}"',
            
            # Partages
            'notifications.share.push_title': 'üîÑ Partage',
            'notifications.share.push_body': '{sender_display_name} a partag√© votre post : "{post_content}"',
            'notifications.share.title': 'Votre post a √©t√© partag√© !',
            'notifications.share.body': '{sender_display_name} a partag√© votre post avec ses abonn√©s',
            'notifications.share.email_subject': '{sender_display_name} a partag√© votre post',
            'notifications.share.email_body': '{sender_display_name} a partag√© votre post : "{post_content}". Cela aide √† diffuser votre contenu !',
            
            # === INTERACTIONS SOCIALES ===
            # Demandes d'ami
            'notifications.friend_request.push_title': 'üë• Demande d\'ami',
            'notifications.friend_request.push_body': '{sender_display_name} veut se connecter avec vous',
            'notifications.friend_request.title': 'Demande d\'ami',
            'notifications.friend_request.body': '{sender_display_name} vous a envoy√© une demande d\'ami',
            'notifications.friend_request.email_subject': 'Demande d\'ami de {sender_display_name}',
            'notifications.friend_request.email_body': '{sender_display_name} veut √™tre votre ami sur l\'app. Acceptez sa demande pour vous connecter !',
            
            # Demande d'ami accept√©e
            'notifications.friend_accept.push_title': 'üéâ Amis',
            'notifications.friend_accept.push_body': '{sender_display_name} a accept√© votre demande d\'ami',
            'notifications.friend_accept.title': 'Vous √™tes maintenant amis !',
            'notifications.friend_accept.body': '{sender_display_name} est maintenant votre ami',
            'notifications.friend_accept.email_subject': '{sender_display_name} a accept√© votre demande d\'ami',
            'notifications.friend_accept.email_body': 'Excellente nouvelle ! {sender_display_name} a accept√© votre demande d\'ami. Vous pouvez maintenant voir vos activit√©s respectives.',
            
            # === INTERACTIONS PROGRAMMES ===
            # Programme bifurqu√©
            'notifications.program_fork.push_title': 'üç¥ Programme',
            'notifications.program_fork.push_body': '{sender_display_name} a bifurqu√© votre programme "{original_program_name}"',
            'notifications.program_fork.title': 'Programme bifurqu√©',
            'notifications.program_fork.body': '{sender_display_name} a bifurqu√© votre programme "{original_program_name}"',
            'notifications.program_fork.email_subject': '{sender_display_name} a bifurqu√© votre programme',
            'notifications.program_fork.email_body': '{sender_display_name} a trouv√© votre programme "{original_program_name}" utile et a cr√©√© sa propre version !',
            
            # Programme partag√©
            'notifications.program_shared.push_title': 'üì§ Programme',
            'notifications.program_shared.push_body': '{sender_display_name} a partag√© "{program_name}" avec vous',
            'notifications.program_shared.title': 'Programme partag√©',
            'notifications.program_shared.body': '{sender_display_name} a partag√© un programme avec vous',
            'notifications.program_shared.email_subject': '{sender_display_name} a partag√© un programme avec vous',
            'notifications.program_shared.email_body': '{sender_display_name} a partag√© son programme "{program_name}" avec vous. D√©couvrez-le !',
            
            # Programme aim√©
            'notifications.program_liked.push_title': '‚ù§Ô∏è Programme',
            'notifications.program_liked.push_body': '{sender_display_name} a aim√© votre programme "{program_name}"',
            'notifications.program_liked.title': 'Programme aim√©',
            'notifications.program_liked.body': '{sender_display_name} a aim√© votre programme "{program_name}"',
            'notifications.program_liked.email_subject': '{sender_display_name} a aim√© votre programme',
            'notifications.program_liked.email_body': '{sender_display_name} a aim√© votre programme "{program_name}". Continuez √† cr√©er du super contenu !',
            
            # Programme utilis√©
            'notifications.program_used.push_title': 'üèãÔ∏è Programme',
            'notifications.program_used.push_body': '{sender_display_name} a utilis√© votre programme "{program_name}" pour son entra√Ænement',
            'notifications.program_used.title': 'Programme utilis√©',
            'notifications.program_used.body': '{sender_display_name} a utilis√© votre programme "{program_name}" pour son entra√Ænement',
            'notifications.program_used.email_subject': '{sender_display_name} a utilis√© votre programme',
            'notifications.program_used.email_body': '{sender_display_name} a termin√© un entra√Ænement en utilisant votre programme "{program_name}". Votre programme fait la diff√©rence !',
            
            # === OBJECTIFS D'ENTRA√éNEMENT ===
            # Objectif d'entra√Ænement
            'notifications.workout_milestone.push_title': 'üèÜ Objectif',
            'notifications.workout_milestone.push_body': 'Vous avez termin√© {workout_count} entra√Ænements ! Continuez !',
            'notifications.workout_milestone.title': 'üéâ Objectif d\'entra√Ænement atteint !',
            'notifications.workout_milestone.body': 'F√©licitations ! Vous avez termin√© {workout_count} entra√Ænements. Vous √©crasez vos objectifs fitness !',
            'notifications.workout_milestone.email_subject': 'Objectif atteint : {workout_count} entra√Ænements !',
            'notifications.workout_milestone.email_body': 'Travail fantastique ! Vous avez atteint un objectif majeur en terminant {workout_count} entra√Ænements. Continuez ces progr√®s formidables !',
            
            # Objectif de s√©rie
            'notifications.streak_milestone.push_title': 'üî• S√©rie',
            'notifications.streak_milestone.push_body': '{streak_days} jours d\'entra√Ænement cons√©cutifs ! Vous √™tes en feu !',
            'notifications.streak_milestone.title': 'Objectif de s√©rie atteint !',
            'notifications.streak_milestone.body': 'Incroyable ! Vous avez maintenu une s√©rie de {streak_days} jours d\'entra√Ænement',
            'notifications.streak_milestone.email_subject': 'Objectif de s√©rie : {streak_days} jours !',
            'notifications.streak_milestone.email_body': 'Vous √™tes inarr√™table ! Vous avez maintenu une s√©rie de {streak_days} jours d\'entra√Ænement. La constance est la cl√© du succ√®s !',
            
            # Record personnel
            'notifications.personal_record.push_title': 'üí™ Record',
            'notifications.personal_record.push_body': 'Nouveau record personnel en {exercise_name} : {new_weight}{weight_unit}',
            'notifications.personal_record.title': 'Record personnel !',
            'notifications.personal_record.body': 'Vous avez √©tabli un nouveau record personnel en {exercise_name} : {new_weight}{weight_unit} (pr√©c√©dent : {previous_weight}{weight_unit})',
            'notifications.personal_record.email_subject': 'Nouveau record personnel en {exercise_name} !',
            'notifications.personal_record.email_body': 'F√©licitations ! Vous venez d\'√©tablir un nouveau record personnel en {exercise_name} : {new_weight}{weight_unit}. Le pr√©c√©dent √©tait {previous_weight}{weight_unit}. Continuez √† repousser vos limites !',
            
            # === INTERACTIONS ENTRA√éNEMENTS DE GROUPE ===
            # Invitation d'entra√Ænement
            'notifications.workout_invitation.push_title': 'üèãÔ∏è‚Äç‚ôÄÔ∏è Invitation',
            'notifications.workout_invitation.push_body': '{sender_display_name} vous a invit√© √† "{workout_title}" le {scheduled_time}',
            'notifications.workout_invitation.title': 'Invitation d\'entra√Ænement de groupe',
            'notifications.workout_invitation.body': '{sender_display_name} vous a invit√© √† rejoindre "{workout_title}" le {scheduled_time}',
            'notifications.workout_invitation.email_subject': 'Invitation d\'entra√Ænement de {sender_display_name}',
            'notifications.workout_invitation.email_body': '{sender_display_name} vous a invit√© √† rejoindre son entra√Ænement de groupe "{workout_title}" pr√©vu pour {scheduled_time}. Rejoignez-les pour une super session !',
            
            # Quelqu'un a rejoint l'entra√Ænement
            'notifications.workout_join.push_title': 'üéâ Entra√Ænement',
            'notifications.workout_join.push_body': '{sender_display_name} a rejoint votre entra√Ænement "{workout_title}"',
            'notifications.workout_join.title': 'Nouveau participant',
            'notifications.workout_join.body': '{sender_display_name} a rejoint votre entra√Ænement de groupe "{workout_title}"',
            'notifications.workout_join.email_subject': '{sender_display_name} a rejoint votre entra√Ænement',
            'notifications.workout_join.email_body': 'Excellente nouvelle ! {sender_display_name} a rejoint votre entra√Ænement de groupe "{workout_title}". Plus on est de fous, plus on rit !',
            
            # Demande de participation √† l'entra√Ænement
            'notifications.workout_join_request.push_title': 'üôã‚Äç‚ôÇÔ∏è Demande',
            'notifications.workout_join_request.push_body': '{sender_display_name} veut rejoindre "{workout_title}"',
            'notifications.workout_join_request.title': 'Demande de participation',
            'notifications.workout_join_request.body': '{sender_display_name} a demand√© √† rejoindre votre entra√Ænement de groupe "{workout_title}"',
            'notifications.workout_join_request.email_subject': 'Demande de participation √† votre entra√Ænement',
            'notifications.workout_join_request.email_body': '{sender_display_name} a demand√© √† rejoindre votre entra√Ænement de groupe "{workout_title}". Examinez sa demande dans l\'app.',
            
            # Demande d'entra√Ænement approuv√©e
            'notifications.workout_request_approved.push_title': '‚úÖ Accept√©',
            'notifications.workout_request_approved.push_body': 'Vous pouvez maintenant rejoindre "{workout_title}"',
            'notifications.workout_request_approved.title': 'Demande de participation approuv√©e',
            'notifications.workout_request_approved.body': 'Votre demande pour rejoindre "{workout_title}" a √©t√© approuv√©e !',
            'notifications.workout_request_approved.email_subject': 'Demande d\'entra√Ænement approuv√©e !',
            'notifications.workout_request_approved.email_body': 'Bonne nouvelle ! Votre demande pour rejoindre "{workout_title}" a √©t√© approuv√©e. √Ä bient√¥t √† l\'entra√Ænement !',
            
            # Demande d'entra√Ænement rejet√©e
            'notifications.workout_request_rejected.push_title': '‚ùå Refus√©',
            'notifications.workout_request_rejected.push_body': 'Votre demande pour rejoindre "{workout_title}" a √©t√© refus√©e',
            'notifications.workout_request_rejected.title': 'Demande de participation refus√©e',
            'notifications.workout_request_rejected.body': 'Votre demande pour rejoindre "{workout_title}" a √©t√© refus√©e',
            'notifications.workout_request_rejected.email_subject': 'Demande d\'entra√Ænement refus√©e',
            'notifications.workout_request_rejected.email_body': 'Malheureusement, votre demande pour rejoindre "{workout_title}" a √©t√© refus√©e. Ne vous inqui√©tez pas, il y a plein d\'autres opportunit√©s d\'entra√Ænement !',
            
            # Entra√Ænement annul√©
            'notifications.workout_cancelled.push_title': '‚ö†Ô∏è Annul√©',
            'notifications.workout_cancelled.push_body': '"{workout_title}" a √©t√© annul√©',
            'notifications.workout_cancelled.title': 'Entra√Ænement annul√©',
            'notifications.workout_cancelled.body': 'L\'entra√Ænement de groupe "{workout_title}" a √©t√© annul√©',
            'notifications.workout_cancelled.email_subject': 'Entra√Ænement annul√© : {workout_title}',
            'notifications.workout_cancelled.email_body': 'Malheureusement, l\'entra√Ænement de groupe "{workout_title}" a √©t√© annul√©. Consultez l\'app pour d\'autres opportunit√©s d\'entra√Ænement.',
            
            # Entra√Ænement termin√©
            'notifications.workout_completed.push_title': 'üèÅ Termin√©',
            'notifications.workout_completed.push_body': '"{workout_title}" est maintenant termin√©',
            'notifications.workout_completed.title': 'Entra√Ænement de groupe termin√©',
            'notifications.workout_completed.body': 'L\'entra√Ænement de groupe "{workout_title}" a √©t√© marqu√© comme termin√©',
            'notifications.workout_completed.email_subject': 'Entra√Ænement termin√© : {workout_title}',
            'notifications.workout_completed.email_body': 'Excellent travail ! L\'entra√Ænement de groupe "{workout_title}" est termin√©. Consultez votre journal d\'entra√Ænement pour les d√©tails.',
            
            # Rappel d'entra√Ænement
            'notifications.workout_reminder.push_title': '‚è∞ Rappel',
            'notifications.workout_reminder.push_body': '"{workout_title}" commence dans 1 heure √† {gym_name}',
            'notifications.workout_reminder.title': 'Rappel d\'entra√Ænement',
            'notifications.workout_reminder.body': 'N\'oubliez pas ! "{workout_title}" commence dans 1 heure √† {gym_name}',
            'notifications.workout_reminder.email_subject': 'Rappel d\'entra√Ænement : {workout_title}',
            'notifications.workout_reminder.email_body': 'Petit rappel amical que "{workout_title}" commence dans 1 heure √† {gym_name}. √Ä bient√¥t !',
            
            # === MESSAGES D'ENTRA√éNEMENTS DE GROUPE ===
            'notifications.group_workout_message.push_title': 'üí¨ Message',
            'notifications.group_workout_message.push_body': '{sender_display_name} a envoy√© un message dans le chat "{workout_title}" : "{message_preview}"',
            'notifications.group_workout_message.title': 'Nouveau message d\'entra√Ænement',
            'notifications.group_workout_message.body': '{sender_display_name} a envoy√© un message dans le chat "{workout_title}"',
            'notifications.group_workout_message.email_subject': 'Nouveau message dans {workout_title}',
            'notifications.group_workout_message.email_body': '{sender_display_name} a envoy√© un message dans le chat "{workout_title}" : "{message_preview}"',
            
            # === PROPOSITIONS ET VOTES D'ENTRA√éNEMENT ===
            'notifications.workout_proposal_submitted.push_title': 'üìù Proposition',
            'notifications.workout_proposal_submitted.push_body': '{sender_display_name} a propos√© "{template_name}" pour "{workout_title}"',
            'notifications.workout_proposal_submitted.title': 'Proposition d\'entra√Ænement',
            'notifications.workout_proposal_submitted.body': '{sender_display_name} a propos√© un mod√®le d\'entra√Ænement pour "{workout_title}"',
            'notifications.workout_proposal_submitted.email_subject': 'Nouvelle proposition d\'entra√Ænement pour {workout_title}',
            'notifications.workout_proposal_submitted.email_body': '{sender_display_name} a propos√© le mod√®le d\'entra√Ænement "{template_name}" pour votre entra√Ænement de groupe "{workout_title}". Examinez et votez !',
            
            'notifications.workout_proposal_voted.push_title': 'üó≥Ô∏è Vote',
            'notifications.workout_proposal_voted.push_body': '{sender_display_name} a vot√© pour votre proposition "{template_name}"',
            'notifications.workout_proposal_voted.title': 'Vote sur votre proposition',
            'notifications.workout_proposal_voted.body': '{sender_display_name} a vot√© pour votre proposition d\'entra√Ænement',
            'notifications.workout_proposal_voted.email_subject': 'Vote sur votre proposition d\'entra√Ænement',
            'notifications.workout_proposal_voted.email_body': '{sender_display_name} a vot√© pour votre proposition d\'entra√Ænement "{template_name}" pour "{workout_title}".',
            
            'notifications.workout_proposal_selected.push_title': 'üèÜ S√©lectionn√©',
            'notifications.workout_proposal_selected.push_body': '"{template_name}" sera utilis√© pour "{workout_title}"',
            'notifications.workout_proposal_selected.title': 'Proposition s√©lectionn√©e',
            'notifications.workout_proposal_selected.body': 'Votre proposition d\'entra√Ænement "{template_name}" a √©t√© s√©lectionn√©e pour "{workout_title}"',
            'notifications.workout_proposal_selected.email_subject': 'Votre proposition d\'entra√Ænement a √©t√© s√©lectionn√©e !',
            'notifications.workout_proposal_selected.email_body': 'F√©licitations ! Votre proposition d\'entra√Ænement "{template_name}" a √©t√© s√©lectionn√©e pour l\'entra√Ænement de groupe "{workout_title}". Excellent choix !',
            
            # === PARTENAIRES D'ENTRA√éNEMENT ===
            'notifications.workout_partner_added.push_title': 'ü§ù Partenaire',
            'notifications.workout_partner_added.push_body': '{sender_display_name} vous a ajout√© comme partenaire d\'entra√Ænement pour "{workout_name}"',
            'notifications.workout_partner_added.title': 'Partenaire d\'entra√Ænement',
            'notifications.workout_partner_added.body': '{sender_display_name} vous a ajout√© comme partenaire d\'entra√Ænement pour "{workout_name}"',
            'notifications.workout_partner_added.email_subject': 'Ajout√© comme partenaire d\'entra√Ænement',
            'notifications.workout_partner_added.email_body': '{sender_display_name} vous a ajout√© comme partenaire d\'entra√Ænement pour son entra√Ænement "{workout_name}" le {workout_date}.',
            
            'notifications.workout_partner_request.push_title': 'ü§ù Demande',
            'notifications.workout_partner_request.push_body': '{sender_display_name} veut √™tre votre partenaire d\'entra√Ænement',
            'notifications.workout_partner_request.title': 'Demande de partenariat',
            'notifications.workout_partner_request.body': '{sender_display_name} vous a envoy√© une demande de partenariat d\'entra√Ænement',
            'notifications.workout_partner_request.email_subject': 'Demande de partenariat d\'entra√Ænement de {sender_display_name}',
            'notifications.workout_partner_request.email_body': '{sender_display_name} veut √™tre votre partenaire d\'entra√Ænement. Avoir un partenaire peut √™tre une excellente motivation !',
            
            # === INTERACTIONS MOD√àLES ===
            'notifications.template_used.push_title': 'üìã Mod√®le',
            'notifications.template_used.push_body': '{sender_display_name} a utilis√© votre mod√®le "{template_name}" pour son entra√Ænement "{workout_name}"',
            'notifications.template_used.title': 'Mod√®le utilis√©',
            'notifications.template_used.body': '{sender_display_name} a utilis√© votre mod√®le d\'entra√Ænement pour son entra√Ænement',
            'notifications.template_used.email_subject': '{sender_display_name} a utilis√© votre mod√®le',
            'notifications.template_used.email_body': '{sender_display_name} a utilis√© votre mod√®le d\'entra√Ænement "{template_name}" pour son entra√Ænement "{workout_name}". Votre mod√®le aide les autres !',
            
            'notifications.template_forked.push_title': 'üç¥ Mod√®le',
            'notifications.template_forked.push_body': '{sender_display_name} a bifurqu√© votre mod√®le "{template_name}"',
            'notifications.template_forked.title': 'Mod√®le bifurqu√©',
            'notifications.template_forked.body': '{sender_display_name} a bifurqu√© votre mod√®le d\'entra√Ænement',
            'notifications.template_forked.email_subject': '{sender_display_name} a bifurqu√© votre mod√®le',
            'notifications.template_forked.email_body': '{sender_display_name} a trouv√© votre mod√®le "{template_name}" si utile qu\'il a cr√©√© sa propre version !',
            
            # === OBJECTIFS ET R√âUSSITES ===
            'notifications.goal_achieved.push_title': 'üéØ Objectif',
            'notifications.goal_achieved.push_body': 'Vous avez atteint votre objectif : {goal_name}',
            'notifications.goal_achieved.title': 'Objectif accompli !',
            'notifications.goal_achieved.body': 'F√©licitations ! Vous avez atteint votre objectif : {goal_name}',
            'notifications.goal_achieved.email_subject': 'Objectif atteint : {goal_name}',
            'notifications.goal_achieved.email_body': 'Travail fantastique ! Vous avez r√©ussi √† atteindre votre objectif : {goal_name}. Il est temps de vous fixer un nouveau d√©fi !',
            
            # === NOTIFICATIONS SYST√àME ===
            'notifications.gym_announcement.push_title': 'üì¢ Annonce',
            'notifications.gym_announcement.push_body': 'Nouvelle annonce de {gym_name} : {announcement_content}',
            'notifications.gym_announcement.title': 'Mise √† jour de la salle',
            'notifications.gym_announcement.body': 'Nouvelle annonce de {gym_name} : {announcement_content}',
            'notifications.gym_announcement.email_subject': 'Annonce de {gym_name}',
            'notifications.gym_announcement.email_body': 'Votre salle {gym_name} a une nouvelle annonce : {announcement_content}',
            
            'notifications.system_update.push_title': 'üîÑ Mise √† jour',
            'notifications.system_update.push_body': 'Nouvelles fonctionnalit√©s disponibles : {update_description}',
            'notifications.system_update.title': 'Mise √† jour syst√®me',
            'notifications.system_update.body': 'De nouvelles fonctionnalit√©s de l\'app sont disponibles : {update_description}',
            'notifications.system_update.email_subject': 'Mise √† jour de l\'app disponible',
            'notifications.system_update.email_body': 'Excellente nouvelle ! Une nouvelle mise √† jour de l\'app est disponible avec des fonctionnalit√©s passionnantes : {update_description}',
            
            # Test notification
            'notifications.test.push_title': 'üß™ Test',
            'notifications.test.push_body': 'Ceci est une notification push de test de votre app fitness !',
            'notifications.test.title': 'Notification de test',
            'notifications.test.body': 'Notification de test - tout fonctionne correctement !',
            'notifications.test.email_subject': 'Notification de test',
            'notifications.test.email_body': 'Ceci est un email de test pour v√©rifier que vos param√®tres de notification fonctionnent correctement.',
        },
    }
    
    @classmethod
    def translate(cls, key: str, language: str = 'en', params: Dict[str, Any] = None) -> str:
        """
        Translate a notification key to the specified language
        
        Args:
            key: Translation key (e.g., 'notifications.comment.push_title')
            language: Language code (e.g., 'en', 'fr', 'es')
            params: Parameters for string interpolation
            
        Returns:
            Translated and interpolated string
        """
        if params is None:
            params = {}
        
        # Get language translations, fallback to English
        lang_translations = cls.TRANSLATIONS.get(language, cls.TRANSLATIONS['en'])
        
        # Get the translation, fallback to English if not found
        translation = lang_translations.get(key)
        if translation is None:
            translation = cls.TRANSLATIONS['en'].get(key, key)
        
        # Format the string with parameters
        try:
            return translation.format(**params)
        except (KeyError, ValueError) as e:
            # If formatting fails, return the unformatted string
            print(f"Translation formatting error for key '{key}': {e}")
            return translation
    
    @classmethod
    def get_user_language(cls, user) -> str:
        """Get user's preferred language, with fallback to English"""
        return getattr(user, 'language_preference', 'en') or 'en'
    
    @classmethod
    def translate_notification(cls, user, title_key: str, body_key: str, params: Dict[str, Any] = None) -> Dict[str, str]:
        """
        Translate notification title and body for a specific user
        
        Args:
            user: User object with language_preference
            title_key: Translation key for title
            body_key: Translation key for body  
            params: Parameters for translation
            
        Returns:
            Dictionary with translated 'title' and 'body'
        """
        language = cls.get_user_language(user)
        
        return {
            'title': cls.translate(title_key, language, params),
            'body': cls.translate(body_key, language, params)
        }

# Create a singleton instance
translation_service = NotificationTranslationService()